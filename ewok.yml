box: nodesource/node:trusty
# Build definition
build:
  # The steps that will be executed on build
    steps:
      - script:
            name: set up permissions
            code: |
              chmod 777 -R .
              chmod 777 -R $WERCKER_CACHE_DIR
      # install npm2
      - script:
            name: install npm@2
            code: | 
              sudo npm i -g npm
              sudo npm install
    
              #- npm-install
        
      - script:
            name: npm postinstall
            code: |
                rm -rf node_modules/@local
                ./node_modules/.bin/linklocal link -r
                ./node_modules/.bin/linklocal list -r | ./node_modules/.bin/bulk -c 'npm install'
        
      # build the docs    
      - hgen/gulp:
            tasks: build
